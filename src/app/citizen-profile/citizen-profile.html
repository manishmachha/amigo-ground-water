<div class="bg-slate-50 p-6">

  <!-- HEADER -->
  <div class="flex items-center justify-between mb-6">
    <span class="text-blue-600 cursor-pointer text-sm" routerLink="/citizen-portal">‚Üê Back to Dashboard</span>
    <h1 class="text-2xl font-bold text-gray-900">My Profile</h1>
  </div>

  <!-- TABS -->
  <div class="inline-flex items-center gap-1 rounded-full border border-gray-200 bg-white p-1 mb-8">
    <button (click)="switchTab('personal')" class="px-4 py-2 rounded-full text-sm"
      [ngClass]="activeTab==='personal' ? 'bg-gray-100 font-semibold' : 'text-gray-600'">
      <i class="bi bi-person"></i> Personal Info
    </button>

    <button (click)="switchTab('contact')" class="px-4 py-2 rounded-full text-sm"
      [ngClass]="activeTab==='contact' ? 'bg-gray-100 font-semibold' : 'text-gray-600'">
      <i class="bi bi-telephone"></i> Contact
    </button>

    <button (click)="switchTab('documents')" class="px-4 py-2 rounded-full text-sm"
      [ngClass]="activeTab==='documents' ? 'bg-gray-100 font-semibold' : 'text-gray-600'">
      <i class="bi bi-file-earmark-text"></i> Documents
    </button>

    <button (click)="switchTab('security')" class="px-4 py-2 rounded-full text-sm"
      [ngClass]="activeTab==='security' ? 'bg-gray-100 font-semibold' : 'text-gray-600'">
      <i class="bi bi-lock"></i> Security
    </button>

    <button (click)="switchTab('notifications')" class="px-4 py-2 rounded-full text-sm"
      [ngClass]="activeTab==='notifications' ? 'bg-gray-100 font-semibold' : 'text-gray-600'">
      <i class="bi bi-bell"></i> Notifications
    </button>
  </div>

  <!-- ================= PERSONAL ================= -->
    <div *ngIf="activeTab==='personal'" class="bg-white rounded-2xl border p-8">

      <div class="flex justify-between mb-6">
        <h2 class="text-lg font-semibold">Personal Information</h2>

        <button *ngIf="!editMode.personal" (click)="enableEdit('personal')"
          class="px-4 py-2 border rounded-lg text-sm">
          <i class="bi bi-pencil"></i> Edit
        </button>

        <button *ngIf="editMode.personal" (click)="cancelEdit('personal')"
          class="px-4 py-2 border rounded-lg text-sm">
          Cancel
        </button>
      </div>

      <ng-container *ngIf="!editMode.personal">
        <form [formGroup]="personalForm" class="grid md:grid-cols-2 gap-6">
          <input class="input" formControlName="fullName" readonly>
          <input class="input" formControlName="dob" readonly>
          <input class="input" formControlName="gender" readonly>
          <input class="input" formControlName="aadhaar" readonly>
          <input class="input" formControlName="pan" readonly>
        </form>
      </ng-container>

      <ng-container *ngIf="editMode.personal">
        <!-- <amigo-form
          [formId]="currentFormId"
          (submitted)="saveChanges('personal')"
          (submitFailed)="onFormSubmitFailed($event)">
        </amigo-form> -->

        <amigo-form
         [formId]="currentFormId"
        (submitted)="onFormSubmitted($event)"
        (submitFailed)="onFormSubmitFailed($event)"
        [initialValue]="editMode
        ">
      </amigo-form>
      </ng-container>

    </div>

    <!-- ================= CONTACT ================= -->
    <div *ngIf="activeTab==='contact'" class="bg-white rounded-2xl border p-8 mt-6">

      <div class="flex justify-between mb-6">
        <h2 class="text-lg font-semibold">Contact Information</h2>

        <button *ngIf="!editMode.contact" (click)="enableEdit('contact')" class="btn">
          Edit
        </button>

        <button *ngIf="editMode.contact" (click)="cancelEdit('contact')" class="btn">
          Cancel
        </button>
      </div>

      <form [formGroup]="contactForm" class="grid md:grid-cols-2 gap-6">
        <input class="input" formControlName="email" [readonly]="!editMode.contact">
        <input class="input" formControlName="mobileNumber" [readonly]="!editMode.contact">
        <input class="input" formControlName="altMobile" [readonly]="!editMode.contact">
        <input class="input" formControlName="whatsapp" [readonly]="!editMode.contact">
        <input class="input md:col-span-2" formControlName="address1" [readonly]="!editMode.contact">
        <input class="input md:col-span-2" formControlName="address2" [readonly]="!editMode.contact">
      </form>

      <div *ngIf="editMode.contact" class="flex justify-end mt-6">
        <button (click)="saveChanges('contact')" class="save-btn">Save Changes</button>
      </div>

      <ng-container *ngIf="editMode.contact">
        <amigo-form
          [formId]="currentFormId"
          (submitted)="saveChanges('contact')"
          (submitFailed)="onFormSubmitFailed($event)">
        </amigo-form>
      </ng-container>
    </div>

  <!-- ================= DOCUMENTS ================= -->
  <div *ngIf="activeTab==='documents'" class="bg-white rounded-2xl border p-8 mt-6">

    <div class="flex justify-between mb-6">
      <h2 class="text-lg font-semibold">Documents</h2>

      <button *ngIf="!editMode.documents" (click)="enableEdit('documents')" class="btn">
        Edit
      </button>

      <button *ngIf="editMode.documents" (click)="cancelEdit('documents')" class="btn">
        Cancel
      </button>
    </div>
    
<h2 class="text-lg font-semibold text-gray-900 mb-6">
    Identity Documents
  </h2>

  <!-- Aadhaar -->
  <div class="flex items-center justify-between border border-gray-200 rounded-xl p-4 mb-4">
    <div class="flex items-center gap-4">
      <div class="w-12 h-12 rounded-lg bg-green-100 flex items-center justify-center">
        <i class="bi bi-file-earmark-text text-green-600 text-xl"></i>
      </div>
      <div>
        <p class="font-medium text-gray-900">Aadhaar Card</p>
        <p class="text-sm text-gray-500">Uploaded: 15 Jan 2024</p>
      </div>
    </div>

    <div class="flex items-center gap-4">
      <span class="px-3 py-1 rounded-full text-xs bg-green-100 text-green-700">
        Verified
      </span>
      <button class="flex items-center gap-2 px-4 py-2 rounded-lg border border-gray-300 text-sm">
        <i class="bi bi-upload"></i> Replace
      </button>
    </div>
  </div>

  <!-- PAN -->
  <div class="flex items-center justify-between border border-gray-200 rounded-xl p-4 mb-4">
    <div class="flex items-center gap-4">
      <div class="w-12 h-12 rounded-lg bg-green-100 flex items-center justify-center">
        <i class="bi bi-file-earmark-text text-green-600 text-xl"></i>
      </div>
      <div>
        <p class="font-medium text-gray-900">PAN Card</p>
        <p class="text-sm text-gray-500">Uploaded: 15 Jan 2024</p>
      </div>
    </div>

    <div class="flex items-center gap-4">
      <span class="px-3 py-1 rounded-full text-xs bg-green-100 text-green-700">
        Verified
      </span>
      <button class="flex items-center gap-2 px-4 py-2 rounded-lg border border-gray-300 text-sm">
        <i class="bi bi-upload"></i> Replace
      </button>
    </div>
  </div>

  <!-- Voter ID -->
  <div class="flex items-center justify-between border border-gray-200 rounded-xl p-4 mb-4">
    <div class="flex items-center gap-4">
      <div class="w-12 h-12 rounded-lg bg-yellow-100 flex items-center justify-center">
        <i class="bi bi-file-earmark-text text-yellow-600 text-xl"></i>
      </div>
      <div>
        <p class="font-medium text-gray-900">Voter ID</p>
        <p class="text-sm text-gray-500">Uploaded: 20 Jan 2024</p>
      </div>
    </div>

    <div class="flex items-center gap-4">
      <span class="px-3 py-1 rounded-full text-xs bg-yellow-100 text-yellow-700">
        Pending Verification
      </span>
      <button class="flex items-center gap-2 px-4 py-2 rounded-lg border border-gray-300 text-sm">
        <i class="bi bi-upload"></i> Replace
      </button>
    </div>
  </div>

  <!-- Passport -->
  <div class="flex items-center justify-between border border-gray-200 rounded-xl p-4">
    <div class="flex items-center gap-4">
      <div class="w-12 h-12 rounded-lg bg-gray-100 flex items-center justify-center">
        <i class="bi bi-file-earmark-text text-gray-500 text-xl"></i>
      </div>
      <div>
        <p class="font-medium text-gray-900">Passport</p>
        <p class="text-sm text-gray-500">Not uploaded yet</p>
      </div>
    </div>

    <div class="flex items-center gap-4">
      <span class="px-3 py-1 rounded-full text-xs bg-gray-100 text-gray-600">
        Not Uploaded
      </span>
      <button class="flex items-center gap-2 px-4 py-2 rounded-lg border border-gray-300 text-sm">
        <i class="bi bi-upload"></i> Upload
      </button>
    </div>
  </div>
    <div *ngIf="editMode.documents" class="flex justify-end">
      <button (click)="saveChanges('documents')" class="save-btn">Save Changes</button>
    </div>

    <ng-container *ngIf="editMode.documents">
      <amigo-form
         [formId]="currentFormId"
        (submitted)="saveChanges('documents')"
        (submitFailed)="onFormSubmitFailed($event)">
      </amigo-form>
    </ng-container>
  </div>

  <!-- ================= SECURITY ================= -->
  <div *ngIf="activeTab==='security'" class="bg-white rounded-2xl border p-8 mt-6">

    <div class="flex justify-between mb-6">
      <h2 class="text-lg font-semibold">Change Password</h2>

      <button *ngIf="!editMode.security" (click)="enableEdit('security')" class="btn">
        Edit
      </button>

      <button *ngIf="editMode.security" (click)="cancelEdit('security')" class="btn">
        Cancel
      </button>
    </div>

    <form [formGroup]="passwordForm" class="space-y-6">
      <input class="input" formControlName="currentPassword" placeholder="Current Password">
      <input class="input" formControlName="newPassword" placeholder="New Password">
      <input class="input" formControlName="confirmPassword" placeholder="Confirm Password">
    </form>

    <div *ngIf="editMode.security" class="flex justify-end mt-6">
      <button (click)="saveChanges('security')" class="save-btn">Update Password</button>
    </div>
    <ng-container *ngIf="editMode.security">
      <amigo-form
         [formId]="currentFormId"
        (submitted)="saveChanges('security')"
        (submitFailed)="onFormSubmitFailed($event)">
      </amigo-form>
    </ng-container>
  </div>

  <!-- ================= NOTIFICATIONS ================= -->
  <div *ngIf="activeTab==='notifications'" class="bg-white rounded-2xl border p-8 mt-6">

    <div class="flex justify-between mb-6">
      <h2 class="text-lg font-semibold">Notifications</h2>

      <button *ngIf="!editMode.notifications" (click)="enableEdit('notifications')" class="btn">
        Edit
      </button>

      <button *ngIf="editMode.notifications" (click)="cancelEdit('notifications')" class="btn">
        Cancel
      </button>
    </div>

    <form [formGroup]="notificationForm" class="space-y-4">
      <div>
      <p class="font-medium text-gray-900">
        Application Updates
      </p>
      <p class="text-sm text-gray-500 mb-3">
        Notifications about your NOC/Well applications
      </p>

      <div class="flex items-center gap-6 text-sm">
        <label class="flex items-center gap-2">
          <input type="checkbox" formControlName="appEmail">
          Email
        </label>
        <label class="flex items-center gap-2">
          <input type="checkbox" formControlName="appSMS">
          SMS
        </label>
        <label class="flex items-center gap-2">
          <input type="checkbox" formControlName="appWhatsapp">
          WhatsApp
        </label>
      </div>
    </div>

    <hr>

    <!-- Payment Reminders -->
    <div>
      <p class="font-medium text-gray-900">
        Payment Reminders
      </p>
      <p class="text-sm text-gray-500 mb-3">
        Billing and payment due date reminders
      </p>

      <div class="flex items-center gap-6 text-sm">
        <label class="flex items-center gap-2">
          <input type="checkbox" formControlName="payEmail">
          Email
        </label>
        <label class="flex items-center gap-2">
          <input type="checkbox" formControlName="paySMS">
          SMS
        </label>
      </div>
    </div>

    <hr>

    <!-- Compliance Alerts -->
    <div>
      <p class="font-medium text-gray-900">
        Compliance Alerts
      </p>
      <p class="text-sm text-gray-500 mb-3">
        Important compliance and regulatory updates
      </p>

      <div class="flex items-center gap-6 text-sm">
        <label class="flex items-center gap-2">
          <input type="checkbox" formControlName="compEmail">
          Email
        </label>
        <label class="flex items-center gap-2">
          <input type="checkbox" formControlName="compWhatsapp">
          WhatsApp
        </label>
        <label class="flex items-center gap-2">
          <input type="checkbox" formControlName="compPortal">
          Portal
        </label>
      </div>
    </div>
    </form>

    <div *ngIf="editMode.notifications" class="flex justify-end mt-6">
      <button (click)="saveChanges('notifications')" class="save-btn">Save Preferences</button>
    </div>

     <ng-container *ngIf="editMode.notifications">
      <amigo-form
         [formId]="currentFormId"
        (submitted)="onFormSubmitted($event)"
        (submitFailed)="onFormSubmitFailed($event)">
      </amigo-form>
    </ng-container>
  </div>

</div>
